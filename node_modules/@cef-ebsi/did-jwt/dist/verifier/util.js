"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const base64url_1 = __importDefault(require("base64url"));
function toSignatureObject(signature, recoverable = false) {
    const rawsig = base64url_1.default.toBuffer(signature);
    if (rawsig.length !== (recoverable ? 65 : 64)) {
        throw new Error("wrong signature length");
    }
    const r = rawsig.slice(0, 32).toString("hex");
    const s = rawsig.slice(32, 64).toString("hex");
    const sigObj = { r, s };
    if (recoverable) {
        const n = rawsig[64];
        sigObj.recoveryParam = n;
    }
    return sigObj;
}
exports.default = toSignatureObject;
//# sourceMappingURL=util.js.map