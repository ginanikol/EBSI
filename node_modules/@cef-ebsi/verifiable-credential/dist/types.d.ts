import type { JWK, JWTPayload } from "jose";
import { EBSIVerifiableAttestation } from "./types/EBSIVerifiableAttestation";
import { EBSIVerifiableAccreditationRecord } from "./types/EBSIVerifiableAccreditationRecord";
export interface EbsiEnvConfiguration {
    didRegistry: string;
    trustedIssuersRegistry: string;
    trustedPoliciesRegistry: string;
}
export type EbsiVerifiableAttestation = EBSIVerifiableAttestation;
export type EbsiVerifiableAccreditation = EBSIVerifiableAccreditationRecord;
/**
 * `createVerifiableCredentialJwt` options
 */
export interface CreateVerifiableCredentialOptions {
    /**
     * Determines whether to validate the Verifiable Credential payload or not.
     * Validation is active by default.
     *
     * Note: even when skipValidation is set to true, the payload must be a valid
     * EBSI Verifiable Attestation.
     *
     * @defaultValue false
     */
    skipValidation?: boolean;
    /**
     * Determines whether to validate the accreditations of the VC issuer or not.
     * Validation is active by default.
     *
     * @defaultValue false
     */
    skipAccreditationsValidation?: boolean;
    /**
     * Determines whether to validate the credential status or not
     * Validation is active by default.
     *
     * @defaultValue false
     */
    skipStatusValidation?: boolean;
    /**
     * Defines the URI authority where the EBSI APIs can be found.
     *
     * For more information about what the URI authority component is, read:
     * - https://en.wikipedia.org/wiki/Uniform_Resource_Identifier#Syntax
     * - https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_URL#authority
     *
     * Accepted host names:
     * - localhost (for development purpose only)
     * - api-test.ebsi.eu + api-conformance.ebsi.eu + api-pilot.ebsi.eu OR any of the hostnames in `trustedHostnames`
     */
    ebsiAuthority: string;
    /**
     * EBSI environment configuration.
     * This option allows you to override the default URLs (TIR, DIDR, TSR).
     */
    ebsiEnvConfig?: EbsiEnvConfiguration;
    /**
     * Axios requests timeout (in milliseconds). Default: 15 seconds
     */
    timeout?: number;
    /**
     * List of trusted hostnames running the EBSI Core Services APIs.
     * If `trustedHostnames` is not defined, the default trusted domains are: "api-test.ebsi.eu", "api-conformance.ebsi.eu", and "api-pilot.ebsi.eu"
     */
    trustedHostnames?: string[];
}
/**
 * `verifyCredentialJwt` options
 */
export interface VerifyCredentialOptions {
    /**
     * Determines whether the JSON to JWT transformation will remove the
     * original fields from the input payload.
     * See https://www.w3.org/TR/vc-data-model/#jwt-encoding
     *
     * @defaultValue true
     */
    removeOriginalFields?: boolean;
    /**
     * Determines whether to validate the accreditations of the VC issuer or not.
     * Validation is active by default.
     *
     * @defaultValue false
     */
    skipAccreditationsValidation?: boolean;
    /**
     * Determines whether to validate the credential status or not.
     * Validation is active by default.
     *
     * @defaultValue false
     */
    skipStatusValidation?: boolean;
    /**
     * Determines whether or not to validate the issuer's accreditations when `termsOfUse` is missing.
     *
     * @defaultValue false
     */
    validateAccreditationWithoutTermsOfUse?: boolean;
    /**
     * Defines the URI authority where the EBSI APIs can be found.
     *
     * For more information about what the URI authority component is, read:
     * - https://en.wikipedia.org/wiki/Uniform_Resource_Identifier#Syntax
     * - https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_URL#authority
     *
     * Accepted host names:
     * - localhost (for development purpose only)
     * - api-test.ebsi.eu + api-conformance.ebsi.eu + api-pilot.ebsi.eu OR any of the hostnames in `trustedHostnames`
     */
    ebsiAuthority: string;
    /**
     * EBSI environment configuration.
     * This option allows you to override the default URLs (TIR, DIDR, TSR).
     */
    ebsiEnvConfig?: EbsiEnvConfiguration;
    /**
     * Unix timestamp. Optional comparison date.
     * For the JWT to be valid, `nbf` ≤ `validAt` ≤ `exp`.
     */
    validAt?: number;
    /**
     * Axios requests timeout (in milliseconds). Default: 15 seconds
     */
    timeout?: number;
    /**
     * List of trusted hostnames running the EBSI Core Services APIs.
     * If `trustedHostnames` is not defined, the default trusted domains are: "api-test.ebsi.eu", "api-conformance.ebsi.eu", and "api-pilot.ebsi.eu"
     */
    trustedHostnames?: string[];
}
/**
 * Information about the issuer (DID, kid, public and private JWKs, alg)
 */
export interface EbsiIssuer {
    kid: string;
    did: string;
    publicKeyJwk: JWK;
    privateKeyJwk: JWK;
    alg: "ES256" | "ES256K" | "EdDSA";
}
/**
 * Trusted Issuer
 */
export interface TrustedIssuer {
    did: string;
    attributes: {
        hash: string;
        body: string;
    }[];
}
export interface VcJwtPayload extends JWTPayload {
    iss: string;
    sub: string;
    vc: EBSIVerifiableAttestation;
    jti: string;
}
