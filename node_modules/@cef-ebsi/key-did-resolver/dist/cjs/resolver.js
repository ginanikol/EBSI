"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getResolver = void 0;
const constants_js_1 = require("./constants.js");
const index_js_1 = require("./errors/index.js");
const internals_js_1 = require("./internals.js");
function getResolver() {
    function resolve(did, _, __, didResolutionOptions) {
        try {
            const contentType = (didResolutionOptions === null || didResolutionOptions === void 0 ? void 0 : didResolutionOptions.accept) || constants_js_1.DID_LD_JSON;
            if (!constants_js_1.SUPPORTED_CONTENT_TYPES.includes(contentType)) {
                throw new index_js_1.RepresentationNotSupportedError(`Representation "${contentType}" is not supported`);
            }
            const didDocument = (0, internals_js_1.resolveDidDoc)(did, contentType);
            return Promise.resolve({
                didDocument,
                didDocumentMetadata: {},
                didResolutionMetadata: { contentType },
            });
        }
        catch (e) {
            if (e instanceof index_js_1.DidResolutionError) {
                return Promise.resolve({
                    didDocument: null,
                    didDocumentMetadata: {},
                    didResolutionMetadata: {
                        error: e.code,
                        message: e.message,
                    },
                });
            }
            const message = e instanceof Error ? e.message : "Unknown error";
            return Promise.resolve({
                didDocument: null,
                didDocumentMetadata: {},
                didResolutionMetadata: {
                    error: "invalidDid",
                    message,
                },
            });
        }
    }
    return { key: resolve };
}
exports.getResolver = getResolver;
//# sourceMappingURL=resolver.js.map