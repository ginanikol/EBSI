![EBSI Logo](https://ec.europa.eu/digital-building-blocks/wikis/images/logo/default-space-logo.svg)

# EBSI DID Resolver

This library supports the proposed `did:ebsi` method from EBSI. Ths DID method is meant to be used by Legal Entities only.
For Natural Persons, the [`did:key` method](https://www.npmjs.com/package/@cef-ebsi/key-did-resolver) must be used.

In order to resolve DID documents, the EBSI DID resolver requires the [`did-resolver`](https://github.com/decentralized-identity/did-resolver) library, which is the primary interface for resolving DIDs.

## Table of Contents

1. [Installation](#Installation)
2. [Resolving a DID document](#Resolving-a-DID-document)
3. [Creating a DID](#Creating-a-DID)
4. [Library Test](#Library-Test)
5. [Licensing](#Licensing)

## Installation

```bash
npm install @cef-ebsi/ebsi-did-resolver
```

or if you use `yarn`:

```bash
yarn add @cef-ebsi/ebsi-did-resolver
```

## Resolving a DID document

The library provides a resolver that is meant to be used through the [`did-resolver`](https://github.com/decentralized-identity/did-resolver) aggregator.

```js
import { Resolver } from "did-resolver";
import { getResolver } from "@cef-ebsi/ebsi-did-resolver";

// You must set the address of the DID Registry to be used in order to resolve Legal Entities DID documents
const resolverConfig = {
  registry: "https://api-pilot.ebsi.eu/did-registry/v5/identifiers",
};

// getResolver will return an object with a key/value pair of { "ebsi": resolver } where resolver is a function used by the generic DID resolver.
const ebsiResolver = getResolver(resolverConfig);
const didResolver = new Resolver(ebsiResolver);

didResolver
  .resolve("did:ebsi:zub5ZZUfHLLptCduwEy8xRj")
  .then((doc) => console.log);

// You can also use ES7 async/await syntax
const doc = await didResolver.resolve("did:ebsi:zub5ZZUfHLLptCduwEy8xRj");
```

## Creating a DID

The library exposes a method allowing you to create a DID from the given subject identifier bytes:

```js
import { util } from "@cef-ebsi/ebsi-did-resolver";
import { randomBytes } from "node:crypto";

const subjectIdentifierBytes = randomBytes(16); // An array of 16 random bytes
const did = util.createDid(subjectIdentifierBytes);
// Example: "did:ebsi:ztRBFfMCY7VAGHH1Ba8Q5o9"
```

## Library Test

Create an `.env` file using `.env.example` and update the env variables.

```bash
# unit tests
$ yarn test:unit

# e2e tests
$ yarn test:e2e

# all the tests
$ yarn test
```

## Licensing

Copyright (c) 2019 European Commission
Licensed under the EUPL, Version 1.2 or - as soon they will be approved by the European Commission - subsequent versions of the EUPL (the "Licence");
You may not use this work except in compliance with the Licence.
You may obtain a copy of the Licence at:

- <https://joinup.ec.europa.eu/page/eupl-text-11-12>

Unless required by applicable law or agreed to in writing, software distributed under the Licence is distributed on an "AS IS" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the Licence for the specific language governing permissions and limitations under the Licence.

Library based on [did-resolver](https://github.com/decentralized-identity/did-resolver) library licensed under Apache 2.0 Copyright 2020 decentralized identity.
