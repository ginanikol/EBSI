"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@transmute/linked-data-proof"),t=e(require("@transmute/jsonld")),i=require("@transmute/jsonld-schema"),n=e(require("moment")),o=require("@transmute/json-web-signature");function a(){return(a=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}function s(e,r){return(s=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}var u=/-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])T(([01][0-9]|2[0-3]):[0-5][0-9]:([0-5][0-9]|60)(\.[0-9]+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?/,c=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5][0-9]([\.,]\d+)?|:60([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,d=/[+-]\d\d:\d\d$/,f=function(e,r){void 0===r&&(r=!1);var t={valid:!1,warnings:[]};c.test(e)||t.warnings.push(e+" is not a legal ISO 8601 Date Time."),u.test(e)||t.warnings.push(e+" is not a XMLSCHEMA11-2 date-time. See: https://www.w3.org/TR/vc-data-model/#issuance-date, https://www.w3.org/TR/xmlschema11-2/#dateTime"),n.suppressDeprecationWarnings=!0;var i=e,o=!1;try{if("60"===i.split(":")[2].substring(0,2)){i=i.replace("60","59");var a=new Date(i);a.setSeconds(new Date(i).getSeconds()+1),i=a.toISOString(),o=!0}}catch(e){}return null===n(i).toISOString()&&t.warnings.push(e+" could not be parsed and serialized as ISO 8601 Date Time."),r&&(o&&t.warnings.push(e+" lost leap second information."),d.test(e)&&t.warnings.push(e+" lost timezone offset information."),new Date(i).getMilliseconds()&&t.warnings.push(e+" lost millisecond information.")),n.suppressDeprecationWarnings=!1,t.valid=0===t.warnings.length,t};function l(e){return"string"==typeof e?e:"id"in e?e.id:void 0}var v=function(e,r){try{var n=r.documentLoader,o=r.strict||"warn";if("ignore"===r.strict)return Promise.resolve(void 0);var a=function(e){var r,t=!1;if("string"==typeof e){var i=e.split("."),n=i[1];if(!JSON.parse(Buffer.from(i[0],"base64").toString()).alg)throw new Error("alg is required in JWT header");r=JSON.parse(Buffer.from(n,"base64").toString()).vc,t=!0}else r=e;return{isJWT:t,credential:r}}(e),s=a.isJWT;return e=a.credential,function(e){if(!e)throw new TypeError('"documentLoader" parameter is required for checking presentations.')}(n),function(e){!function(e){if(!e["@context"])throw new Error(["Verifiable credentials MUST include a @context property.","See: https://www.w3.org/TR/vc-data-model/#dfn-context"].join(""))}(e),function(e){if(!e.type)throw new Error("Verifiable credentials MUST have a type specified. See: https://www.w3.org/TR/vc-data-model/#dfn-type")}(e),function(e){if(!e.credentialSubject)throw new Error("Verifiable credentials MUST include a credentialSubject property. See: https://www.w3.org/TR/vc-data-model/#credential-subject")}(e),function(e){if(!e.issuer)throw new Error("Verifiable credentials MUST include a issuer property. See: https://www.w3.org/TR/vc-data-model/#issuer")}(e),function(e){if(!e.issuanceDate)throw new Error("Verifiable credentials MUST include a issuanceDate. See: https://www.w3.org/TR/vc-data-model/#issuance-date")}(e)}(e),function(e,r,i){!function(e){if(!t.getValues(e,"type").includes("VerifiableCredential"))throw new Error("Verifiable credentials type MUST include `VerifiableCredential`. See: https://www.w3.org/TR/vc-data-model/#dfn-type")}(e),function(e,r,i){if(t.getValues(e,"issuanceDate").length>1)throw new Error('"issuanceDate" property can only have one value.');var n=f(e.issuanceDate,r);if(!n.valid){var o=["issuanceDate is not valid: "+JSON.stringify(n.warnings,null,2),"issuanceDate must be XML Datestring as defined in spec: https://w3c.github.io/vc-data-model/#issuance-date"].join("\n");if("warn"==i&&console.warn(o),"throw"==i)throw new Error(o)}}(e,r,i),function(e,r,t){if("expirationDate"in e){var i=f(e.expirationDate,r);if(!i.valid){var n=["expirationDate is not valid: "+JSON.stringify(i.warnings,null,2),"expirationDate must be XML Datestring as defined in spec: https://w3c.github.io/vc-data-model/#expiration"].join("\n");if("warn"==t&&console.warn(n),"throw"==t)throw new Error(n)}}}(e,r,i),function(e){if(t.getValues(e,"issuer").length>1)throw new Error('"issuer" property can only have one value.');var r=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");if("issuer"in e){var i=l(e.issuer);if(!i)throw new Error("Verifiable credentials issuer:object MUST have an id. See: https://www.w3.org/TR/vc-data-model/#issuer");if(!r.test(i))throw new Error("Verifiable credentials issuer:string MUST be a RFC3986 URI. See: https://www.w3.org/TR/vc-data-model/#issuer, https://www.rfc-editor.org/rfc/rfc3986");if(!i.includes(":"))throw new Error('"issuer" id must be a URL: '+i)}}(e),function(e){if("credentialStatus"in e){if(!e.credentialStatus.id)throw new Error('"credentialStatus" must include an id.');if(!e.credentialStatus.type)throw new Error('"credentialStatus" must include a type.')}}(e),function(e){t.getValues(e,"evidence").forEach((function(e){var r=l(e);if(r&&!r.includes(":"))throw new Error('"evidence" id must be a URL: '+e)}))}(e),function(e){var r=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");if(e.id&&!r.test(e.id))throw new Error(["Verifiable credentials id (if exists) MUST be a RFC3986 URI.","See: https://www.w3.org/TR/vc-data-model/#dfn-id"].join(""))}(e)}(e,s,o),Promise.resolve(function(e,r){try{return Promise.resolve(i.check({input:e,documentLoader:r})).then((function(e){if(!e.ok)throw new Error("credential is not valid JSON-LD: "+JSON.stringify(e.error,null,2))}))}catch(e){return Promise.reject(e)}}(e,n)).then((function(){}))}catch(e){return Promise.reject(e)}};function h(e,r){try{var t=e()}catch(e){return r(e)}return t&&t.then?t.then(void 0,r):t}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var p=function(e){var r,t;function i(r){var t=void 0===r?{}:r;return e.call(this,{controller:t.controller,date:t.date,maxTimestampDelta:t.maxTimestampDelta})||this}return t=e,(r=i).prototype=Object.create(t.prototype),r.prototype.constructor=r,s(r,t),i.prototype.validate=function(r,t){var i=t.document,n=t.suite,o=t.verificationMethod,a=t.documentLoader,s=t.expansionMap;try{var u=this;return Promise.resolve(h((function(){return Promise.resolve(e.prototype.validate.call(u,r,{document:i,suite:n,verificationMethod:o,documentLoader:a,expansionMap:s})).then((function(e){if(!e.valid)throw e.error;var r="string"==typeof i.issuer?i.issuer:i.issuer.id;if(!r)throw new Error("Credential issuer is required.");if(e.controller.id!==r)throw new Error("Credential issuer must match the verification method controller.");return{valid:!0}}))}),(function(e){return{valid:!1,error:e}})))}catch(e){return Promise.reject(e)}},i}(r.purposes.AssertionProofPurpose),m=function(e){try{var t=e.credential,i=e.suite,n=e.documentLoader,o=e.strict||"warn";if(!t)throw new TypeError('"credential" parameter is required for issuing.');return Promise.resolve(v(t,{documentLoader:n,strict:o})).then((function(){if(!n)throw new TypeError('"documentLoader" parameter is required for issuing.');if(!i)throw new TypeError('"suite" parameter is required for issuing.');if(!i.verificationMethod)throw new TypeError('"suite.verificationMethod" property is required.');var o=new p;return r.sign(t,a({purpose:o},e))}))}catch(e){return Promise.reject(e)}},w=function(e){try{var t=e.credential,i=e.checkStatus,n=e.documentLoader;if(void 0!==e.expansionMap)throw new Error("The default options are not being used.");return Promise.resolve(h((function(){if(!t)throw new TypeError('A "credential" property is required for verifying.');return Promise.resolve(v(t,{documentLoader:n})).then((function(){if(t.credentialStatus&&"function"!=typeof e.checkStatus)throw new TypeError('A "checkStatus" function must be given to verify credentials with "credentialStatus".');var n=new p;return Promise.resolve(r.verify(t,a({},e,{purpose:n,compactProof:!1}))).then((function(r){if(!r.verified)return r;var n=function(){if(t.credentialStatus)return Promise.resolve(i(e)).then((function(e){r.statusResult=e,r.statusResult.verified||(r.verified=!1)}))}();return n&&n.then?n.then((function(){return r})):r}))}))}),(function(e){return{verified:!1,results:[{credential:t,verified:!1,error:e}],error:e}})))}catch(e){return Promise.reject(e)}},y=function(e,r){try{var n=r.documentLoader,o=r.domain,a=r.challenge,s=r.strict||"warn";if("string"==typeof e){var u=e.split("."),c=u[1];if(!JSON.parse(Buffer.from(u[0],"base64").toString()).alg)throw new Error("alg is required in JWT header");var d=JSON.parse(Buffer.from(c,"base64").toString());if(e=d.vp,d.aud&&d.aud!==o)throw new Error('"aud" and "domain" does not match this verifiable presentation');if(d.nonce&&d.nonce!==a)throw new Error('"nonce" and "challenge" does not match this verifiable presentation')}if(!e["@context"])throw new Error("Verifiable Presentations MUST include a @context property.");if(!n)throw new TypeError('"documentLoader" parameter is required for checking presentations.');return Promise.resolve(i.check({input:e,documentLoader:n})).then((function(r){if(!r.ok)throw new Error("presentation is not valid JSON-LD: "+JSON.stringify(r.error,null,2));if(!t.getValues(e,"type").includes("VerifiablePresentation"))throw new Error('"type" must include "VerifiablePresentation".');var i=function(){if(e.verifiableCredential){var r=Array.isArray(e.verifiableCredential)?e.verifiableCredential:[e.verifiableCredential];return Promise.resolve(Promise.all(r.map((function(e){try{return Promise.resolve(v(e,{documentLoader:n,strict:s})).then((function(){}))}catch(e){return Promise.reject(e)}})))).then((function(){}))}}();if(i&&i.then)return i.then((function(){}))}))}catch(e){return Promise.reject(e)}},g=function(e){try{var t=e.presentation,i=e.domain,n=e.challenge;return Promise.resolve(y(t,{documentLoader:e.documentLoader,strict:e.strict||"warn"})).then((function(){var o=new r.purposes.AuthenticationProofPurpose({domain:i,challenge:n});return r.sign(t,a({},e,{purpose:o}))}))}catch(e){return Promise.reject(e)}},b=function(e,r){try{var t=e.split(".").splice(0,1).map((function(e){return JSON.parse(Buffer.from(e,"base64").toString())}))[0];if(!t.kid)throw new Error('Transmute requires "kid" in vc-jwt headers. Otherwise key dereferencing is not always possible.');var i=Array.isArray(r.suite)?r.suite[0]:r.suite;return Promise.resolve(i.getVerificationMethod({proof:{verificationMethod:t.kid},documentLoader:r.documentLoader,instance:!0})).then((function(e){var r;if(!e||!e.useJwa)throw new Error('Transmute requires "suite.getVerificationMethod" to return a key instance with member useJwa.');null!==(r=i.key)&&void 0!==r&&r.alg&&(e.alg=i.key.alg);var t=o.JsonWebKey.from;return Promise.resolve(e.export({type:"JsonWebKey2020"})).then((function(e){return Promise.resolve(t.call(o.JsonWebKey,e,{detached:!1})).then((function(e){return e.verifier()}))}))}))}catch(e){return Promise.reject(e)}},P=function(e){var r=e.split("."),t=r[2],i=[r[0],r[1]].map((function(e){return JSON.parse(Buffer.from(e,"base64").toString())}));return{header:i[0],payload:i[1],signature:t}},S=function(e,r){try{var t=r.verifier;return Promise.resolve(v(e,{documentLoader:r.documentLoader,strict:r.strict||"warn"})).then((function(){return Promise.resolve(t.verify({signature:e}))}))}catch(e){return Promise.reject(e)}},j=function(e){try{var t=function(t){if(i)return t;function n(){function t(){return f.presentation&&!f.credentials&&(f.verified=f.presentation.verified),f.presentation&&f.credentials&&(f.verified=f.presentation.verified&&f.credentials.verified),f}var i=function(){if(c.proof){var t=new r.purposes.AuthenticationProofPurpose({domain:o,challenge:s});return Promise.resolve(r.verify(c,a({},e,{purpose:t}))).then((function(e){f.presentation=e}))}f.presentation=f.credentials}();return i&&i.then?i.then(t):t()}if(!c.proof&&!c.verifiableCredential||c.verifiableCredential&&0===c.verifiableCredential.length)throw new Error('presentation MUST contain "proof" or "verifiableCredential"');if(!c.proof){var d='presentation MUST contain "proof" when strict';if("warn"==u&&console.warn(d),"throw"==u)throw new Error(d)}var f={verified:!1},l=function(){if(c.verifiableCredential&&c.verifiableCredential.length)return Promise.resolve(function(e,r){try{var t={verified:!1};return Promise.resolve(Promise.all(e.verifiableCredential.map((function(e){try{var t=function(t){if(i)return t;if(e.credentialStatus&&!r.checkStatus)throw new Error("options.checkStatus is required to verify presentation of revocable credentials.");return Promise.resolve(w(a({credential:e},r))).then((function(r){return a({credentialId:e.id},r)}))},i=!1,n=function(){if(!e["@context"])return Promise.resolve(b(e,r)).then((function(t){return Promise.resolve(S(e,a({},r,{verifier:t}))).then((function(r){var t=P(e);return i=!0,{credentialId:t.payload.vc.id||void 0,verified:r}}))}))}();return Promise.resolve(n&&n.then?n.then(t):t(n))}catch(e){return Promise.reject(e)}})))).then((function(e){return t.verified=e.every((function(e){return e.verified})),t.results=e,t}))}catch(e){return Promise.reject(e)}}(c,e)).then((function(e){f.credentials=e,e.verified||(f.verified=!1)}))}();return l&&l.then?l.then(n):n()},i=!1,n=e.documentLoader,o=e.domain,s=e.challenge,u=e.strict||"warn",c=e.presentation;if(!n)throw new TypeError('"documentLoader" parameter is required for verifying.');if(!c)throw new TypeError('A "presentation" property is required for verifying.');var d=h((function(){return Promise.resolve(y(c,{documentLoader:n,strict:u})).then((function(){}))}),(function(e){return i=!0,{verified:!1,presentation:e}}));return Promise.resolve(d&&d.then?d.then(t):t(d))}catch(e){return Promise.reject(e)}},T={__proto__:null,createVerifiableCredential:m,verifyVerifiableCredential:w,createVerifiablePresentation:g,verifyVerifiablePresentation:j},E=function(e,r){try{var t=r.documentLoader,i=r.strict||"warn";if(!e.issuer)throw new Error("Issuer is a required field.");return Promise.resolve(v(e,{documentLoader:t,strict:i})).then((function(){var r=void 0;("string"==typeof e.credentialSubject||e.credentialSubject instanceof String)&&(r=e.credentialSubject),"object"==typeof e.credentialSubject&&null!==e.credentialSubject&&e.credentialSubject.id&&(r=e.credentialSubject.id);var t={iss:e.issuer.id?e.issuer.id:e.issuer,sub:r,vc:e,jti:e.id,nbf:n(e.issuanceDate).unix()};return e.expirationDate&&(t.exp=n(e.expirationDate).unix()),t}))}catch(e){return Promise.reject(e)}},x=function(e,r){try{var t=r.documentLoader,i=r.domain,n=r.challenge,o=r.strict||"warn";if(!n)throw new Error('"challenge" is required to create verifiable presentations (it will be used for the "nonce" value)');return Promise.resolve(y(e,{documentLoader:t,strict:o,domain:i,challenge:n})).then((function(){var r={};if(e.holder){var t=e.holder.id?e.holder.id:e.holder;r.iss=t,r.sub=t}return r.vp=e,i&&(r.aud=i),n&&(r.nonce=n),r}))}catch(e){return Promise.reject(e)}},L=["proof"],D={credential:{create:function(e){try{var r=function(){var r=function(){if(e.format.includes("vc-jwt")){var r=(Array.isArray(e.suite)?e.suite[0]:e.suite).key;if(!r||!r.useJwa)throw new Error("Cannot create credential when suite does not contain a key that supports useJwa.");var i=o.JsonWebKey.from;return Promise.resolve(r.export({type:"JsonWebKey2020",privateKey:!0})).then((function(n){return Promise.resolve(i.call(o.JsonWebKey,n,{detached:!1,header:{kid:r.id}})).then((function(r){var i=r.signer();return Promise.resolve(E(e.credential,e)).then((function(e){var r=t.items,n=r.push;return Promise.resolve(i.sign({data:e})).then((function(e){n.call(r,e)}))}))}))}))}}();return r&&r.then?r.then((function(e){return t})):t},t={items:[]};e.format||(e.format=["vc"]);var i=function(){if(e.format.includes("vc")){var r=t.items,i=r.push;return Promise.resolve(m({credential:e.credential,suite:e.suite,documentLoader:e.documentLoader})).then((function(e){i.call(r,e)}))}}();return Promise.resolve(i&&i.then?i.then(r):r())}catch(e){return Promise.reject(e)}},derive:function(e){try{var r={items:[]};e.format||(e.format=["vc"]);var t=e.credential,i=e.frame,n=e.suite,o=e.documentLoader,s=t.proof,u=function(e,r){if(null==e)return{};var t,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r.indexOf(t=o[i])>=0||(n[t]=e[t]);return n}(t,L);if(!n.deriveProof)throw new Error("Suite requires deriveProof");return Promise.resolve(n.deriveProof({document:u,proof:a({},s,{"@context":u["@context"]}),revealDocument:i,documentLoader:o})).then((function(e){var t=a({},e.document,{proof:e.proof});return delete t.proof["@context"],r.items.push(t),r}))}catch(e){return Promise.reject(e)}},verify:function(e){try{var r=function(){function r(){var r,a,s=!(!i.error||!i.error.find((function(e){var r;return!1===(null==e||null===(r=e.proofResult)||void 0===r?void 0:r.verified)})));if(i.verifications.push(!i.verified&&s?{status:"bad",title:"Proof",description:"This credential has a invalid signature"}:{status:"good",title:"Proof",description:null!==(r=null===(a=e.credential.proof)||void 0===a?void 0:a.verificationMethod)&&void 0!==r?r:o}),t.issuanceDate){var u=n(),c=n(t.issuanceDate);u.isAfter(c)?i.verifications.push({status:"good",title:"Activation",description:"This credential activated "+c.fromNow()}):i.verifications.push({status:"bad",title:"Activation",description:"This credential activates "+c.fromNow()})}if(t.expirationDate){var d=n(),f=n(t.expirationDate);d.isBefore(f)?i.verifications.push({status:"good",title:"Expired",description:"This credential expires "+f.fromNow()}):i.verifications.push({status:"bad",title:"Expired",description:"This credential expired "+f.fromNow()})}if(t.credentialStatus){var l=!(!i.error||!i.error.find((function(e){var r;return!1===(null==e||null===(r=e.statusResult)||void 0===r?void 0:r.verified)})));i.verifications.push(!i.verified&&l?{status:"bad",title:"Revocation",description:"This credential has been revoked."}:{status:"good",title:"Revocation",description:"This credential has not been revoked."})}return i}var o="",a=function(){if(e.format.includes("vc-jwt")&&!e.credential["@context"])return Promise.resolve(b(e.credential,e)).then((function(r){return Promise.resolve(r.verify({signature:e.credential})).then((function(r){var n,a;i.verified=r;var s=P(e.credential);t=s.payload.vc,o=null!==(n=null==s||null===(a=s.header)||void 0===a?void 0:a.kid)&&void 0!==n?n:"object"==typeof s.payload.vc.issuer?s.payload.vc.issuer.id:s.payload.vc.issuer}))}))}();return a&&a.then?a.then(r):r()},t=e.credential,i={verified:!1,verifications:[]};e.format||(e.format=["vc"]);var o=function(){if(e.format.includes("vc")&&e.credential["@context"])return Promise.resolve(w({credential:e.credential,suite:e.suite,documentLoader:e.documentLoader,checkStatus:e.checkStatus,expansionMap:e.expansionMap})).then((function(e){i.verified=e.verified,i.verified||(i.error=[],e&&e.statusResult&&!e.statusResult.verified&&i.error.push({statusResult:e.statusResult}),e&&e.results[0]&&!e.results[0].verified&&(e.results[0].error.message.indexOf("Invalid JSON-LD")>=0&&i.error.push("This credential contains invalid JSON-LD allowing it to be mutable."),i.error.push({proofResult:e.results[0].verified})),e.error&&i.error.push(e.error))}))}();return Promise.resolve(o&&o.then?o.then(r):r())}catch(e){return Promise.reject(e)}}},presentation:{create:function(e){try{var r=function(){var r=function(){if(e.format.includes("vp-jwt")){var r=(Array.isArray(e.suite)?e.suite[0]:e.suite).key;if(!r||!r.useJwa)throw new Error("Cannot create credential when suite does not contain a key that supports useJwa.");var i=o.JsonWebKey.from;return Promise.resolve(r.export({type:"JsonWebKey2020",privateKey:!0})).then((function(n){return Promise.resolve(i.call(o.JsonWebKey,n,{detached:!1,header:{kid:r.id}})).then((function(r){var i=r.signer();return Promise.resolve(x(e.presentation,e)).then((function(e){var r=t.items,n=r.push;return Promise.resolve(i.sign({data:e})).then((function(e){n.call(r,e)}))}))}))}))}}();return r&&r.then?r.then((function(e){return t})):t},t={items:[]};e.format||(e.format=["vp"]);var i=function(){if(e.format.includes("vp")){var r=t.items,i=r.push;return Promise.resolve(g({presentation:e.presentation,suite:e.suite,domain:e.domain,challenge:e.challenge,documentLoader:e.documentLoader})).then((function(e){i.call(r,e)}))}}();return Promise.resolve(i&&i.then?i.then(r):r())}catch(e){return Promise.reject(e)}},verify:function(e){try{var r={verified:!1};if(e.format||(e.format=["vp"]),e.format.includes("vp")&&e.presentation["@context"])return Promise.resolve(j({presentation:e.presentation,suite:e.suite,domain:e.domain,challenge:e.challenge,checkStatus:e.checkStatus,documentLoader:e.documentLoader}));var t=function(){if(e.format.includes("vp-jwt")&&!e.presentation["@context"])return Promise.resolve(b(e.presentation,e)).then((function(t){return Promise.resolve(t.verify({signature:e.presentation})).then((function(e){r.verified=e}))}))}();return Promise.resolve(t&&t.then?t.then((function(){return r})):r)}catch(e){return Promise.reject(e)}}},jwt:{decode:P}};exports.jwt={__proto__:null,createVcPayload:E,createVerifiableCredential:function(e,r){try{var t=r.signer;return Promise.resolve(E(e,r)).then((function(e){return Promise.resolve(t.sign({data:e}))}))}catch(e){return Promise.reject(e)}},verifyVerifiableCredential:S,createVpPayload:x,createVerifiablePresentation:function(e,r){try{var t=r.signer;return Promise.resolve(x(e,r)).then((function(e){return Promise.resolve(t.sign({data:e}))}))}catch(e){return Promise.reject(e)}},verifyVerifiablePresentation:function(e,r){try{var t=r.verifier;return Promise.resolve(y(e,{documentLoader:r.documentLoader,strict:r.strict||"warn",domain:r.domain,challenge:r.challenge})).then((function(){return Promise.resolve(t.verify({signature:e}))}))}catch(e){return Promise.reject(e)}}},exports.ld=T,exports.verifiable=D;
//# sourceMappingURL=vc.js.cjs.production.min.js.map
